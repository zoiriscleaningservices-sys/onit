$DesktopMenu = @"
<div class="absolute -left-32 top-full hidden group-hover:grid grid-cols-3 gap-4 w-[900px] z-[999] pt-2">
  <div class="flex flex-col space-y-2 bg-white/95 p-4 rounded-xl shadow-2xl backdrop-blur-md border border-gray-200">
      <h4 class="text-xl font-bold text-gray-900 border-b-2 border-indigo-500 pb-2 mb-2 text-center">Residential & Property</h4>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/house-cleaning/">House Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/deep-cleaning/">Deep Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/move-in-cleaning/">Move-In Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/move-out-cleaning/">Move-Out Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/carpet-cleaning/">Carpet Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/window-cleaning/">Window Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/pressure-washing/">Pressure Washing</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/luxury-estate-cleaning/">Luxury Estate Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/laundry-services/">Laundry Services</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/Detailing-Mobile-AL/">Detailing</a>
  </div>

  <div class="flex flex-col space-y-2 bg-white/95 p-4 rounded-xl shadow-2xl backdrop-blur-md border border-gray-200">
      <h4 class="text-xl font-bold text-gray-900 border-b-2 border-purple-500 pb-2 mb-2 text-center">Commercial & Industrial</h4>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/commercial-cleaning/">Commercial Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/office-janitorial-services/">Office Janitorial Services</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/janitorial-cleaning-services/">Janitorial Cleaning Services</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/medical-dental-facility-cleaning/">Medical Facility Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/industrial-warehouse-cleaning/">Industrial & Warehouse Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/floor-stripping-waxing/">Floor Stripping & Waxing</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/gym-fitness-center-cleaning/">Gym & Fitness Center Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/school-daycare-cleaning/">School & Daycare Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/church-worship-center-cleaning/">Church & Worship Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/solar-panel-cleaning/">Solar Panel Cleaning</a>
  </div>

  <div class="flex flex-col space-y-2 bg-white/95 p-4 rounded-xl shadow-2xl backdrop-blur-md border border-gray-200">
      <h4 class="text-xl font-bold text-gray-900 border-b-2 border-pink-500 pb-2 mb-2 text-center">Property Management</h4>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/vacation-rental-cleaning/">Vacation Rental Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/airbnb-cleaning/">Airbnb Cleaning</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/airbnb-vacation-rental-management/">Airbnb & Rental Management</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/post-construction-cleanup/">Post-Construction Cleanup</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/property-management-janitorial/">Property Management Janitorial</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/property-maintenance/">Property Maintenance</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/home-watch-services/">Home Watch Services</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/luxury-estate-management/">Luxury Estate Management</a>
      <a class="contact-button text-sm hover:scale-105 transition-transform text-center py-2" href="/services/gutter-cleaning/">Gutter Cleaning</a>
  </div>
</div>
<!-- LOCATIONS Dropdown -->
"@

$MobileMenu = @"
<div class="hidden space-y-3 mt-4" id="mobile-services">
  <div class="bg-gray-50 rounded-lg p-3">
      <h4 class="font-bold text-gray-800 border-b border-gray-300 pb-2 mb-2">Residential & Property</h4>
      <div class="grid grid-cols-1 gap-2">
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/house-cleaning/">House Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/deep-cleaning/">Deep Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/move-in-cleaning/">Move-In Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/move-out-cleaning/">Move-Out Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/carpet-cleaning/">Carpet Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/window-cleaning/">Window Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/pressure-washing/">Pressure Washing</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/luxury-estate-cleaning/">Luxury Estate Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/laundry-services/">Laundry Services</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/Detailing-Mobile-AL/">Detailing</a>
      </div>
  </div>

  <div class="bg-gray-50 rounded-lg p-3">
      <h4 class="font-bold text-gray-800 border-b border-gray-300 pb-2 mb-2">Commercial & Industrial</h4>
      <div class="grid grid-cols-1 gap-2">
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/commercial-cleaning/">Commercial Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/office-janitorial-services/">Office Janitorial</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/janitorial-cleaning-services/">Janitorial Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/medical-dental-facility-cleaning/">Medical Facility</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/industrial-warehouse-cleaning/">Industrial & Warehouse</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/floor-stripping-waxing/">Floor Stripping & Waxing</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/gym-fitness-center-cleaning/">Gym & Fitness Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/school-daycare-cleaning/">School & Daycare Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/church-worship-center-cleaning/">Church Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/solar-panel-cleaning/">Solar Panel Cleaning</a>
      </div>
  </div>

  <div class="bg-gray-50 rounded-lg p-3">
      <h4 class="font-bold text-gray-800 border-b border-gray-300 pb-2 mb-2">Property Management</h4>
      <div class="grid grid-cols-1 gap-2">
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/vacation-rental-cleaning/">Vacation Rental Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/airbnb-cleaning/">Airbnb Cleaning</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/airbnb-vacation-rental-management/">Airbnb Management</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/post-construction-cleanup/">Post-Construction Cleanup</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/property-management-janitorial/">Property Management Janitorial</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/property-maintenance/">Property Maintenance</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/home-watch-services/">Home Watch Services</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/luxury-estate-management/">Luxury Estate Management</a>
          <a class="contact-button text-sm w-full text-center m-0 py-2" href="/services/gutter-cleaning/">Gutter Cleaning</a>
      </div>
  </div>
</div>
<!-- LOCATIONS DROPDOWN (Mobile) -->
"@

$RootDir = "c:\Users\lucia\OneDrive\Desktop\ZOIRISCLEANING"
$ExcludeDirs = @('.git', '.github', 'tmp', '.gemini', 'upload', 'favicon', 'Gallery', 'about', 'contact', 'blog', 'apply')

$files = @()
$files += "$RootDir\index.html"
$dirs = Get-ChildItem -Path $RootDir -Directory | Where-Object { $_.Name -notin $ExcludeDirs }

foreach ($dir in $dirs) {
    if (Test-Path (Join-Path $dir.FullName "index.html")) { $files += Join-Path $dir.FullName "index.html" }
    foreach ($subDir in Get-ChildItem -Path $dir.FullName -Directory) {
        if (Test-Path (Join-Path $subDir.FullName "index.html")) { $files += Join-Path $subDir.FullName "index.html" }
    }
}

$updatedDesktop = 0
$updatedMobile = 0

foreach ($path in $files) {
    $content = [System.IO.File]::ReadAllText($path, [System.Text.Encoding]::UTF8)
    $original = $content
    
    # Replace Desktop Menu (using matching text up to LOCATIONS Dropdown)
    $desktopPattern = '(?is)<div class="absolute[^>]*z-50[^>]*>.*?<!-- LOCATIONS Dropdown -->'
    if ($content -match $desktopPattern) {
        $content = $content -replace $desktopPattern, $DesktopMenu
        $updatedDesktop++
    }
    
    # Replace Mobile Menu
    $mobilePattern = '(?is)<div[^>]*id="mobile-services"[^>]*>.*?<!-- LOCATIONS DROPDOWN \(Mobile\) -->'
    if ($content -match $mobilePattern) {
        $content = $content -replace $mobilePattern, $MobileMenu
        $updatedMobile++
    }
    
    if ($content -ne $original) {
        [System.IO.File]::WriteAllText($path, $content, [System.Text.Encoding]::UTF8)
    }
}

Write-Host "Updated Desktop Menu on $updatedDesktop pages."
Write-Host "Updated Mobile Menu on $updatedMobile pages."
